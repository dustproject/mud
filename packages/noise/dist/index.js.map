<<<<<<< HEAD
{"version":3,"sources":["../ts/index.ts"],"sourcesContent":["import fs from \"fs\";\nimport path from \"path\";\n// import * as buffer from \"buffer\";\n// const { Buffer } = buffer;\n\n// export function encodePackedU32(inputs: number[]): Buffer {\n//   const buffer = Buffer.from(inputs.map((i) => i.toString(16).padStart(8, \"0\")).join(\"\"), \"hex\");\n//   return buffer;\n// }\n\nexport async function fetchAndCompileWasmModule(url: URL | string) {\n  try {\n    return await WebAssembly.compileStreaming(fetch(url));\n  } catch {\n    return WebAssembly.compile(fs.readFileSync(url));\n  }\n}\n\nexport function lerp(t: number, a: number, b: number): number {\n  return a + t * (b - a);\n}\n\nfunction getSplinePoints(splines: [number, number][], x: number) {\n  const index = splines.findIndex((s) => s[0] >= x);\n  if (index > 0) return [splines[index - 1], splines[index]];\n  console.warn(\"out of reach\", x, splines);\n  return undefined;\n}\n\nexport function createSplines(splines: [number, number][]): (x: number) => number {\n  return (x: number) => {\n    const points = getSplinePoints(splines, x);\n    if (!points) return x;\n\n    const t = (x - points[0][0]) / (points[1][0] - points[0][0]);\n    const height = lerp(t, points[0][1], points[1][1]);\n\n    return height;\n  };\n}\n\ntype Perlin = (_x: number, _y: number, _z: number, denom: number) => number;\n\nexport async function createPerlin(): Promise<Perlin> {\n  const wasmModule = await fetchAndCompileWasmModule(\n    import.meta.url\n      ? new URL(\"../build/release.wasm\", import.meta.url)\n      : path.resolve(__dirname, \"../build/release.wasm\"),\n  );\n  const wasmInstance = await WebAssembly.instantiate(wasmModule, {\n    env: {\n      abort: (e: string) => {\n        throw new Error(\"abort called in wasm perlin: \" + e);\n      },\n    },\n  });\n\n  return wasmInstance.exports.perlin as Perlin;\n}\n"],"mappings":"0jBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,kBAAAE,EAAA,kBAAAC,EAAA,8BAAAC,EAAA,SAAAC,IAAA,eAAAC,EAAAN,GAAA,IAAAO,EAAe,iBACfC,EAAiB,mBADjBC,EAAA,GAUA,eAAsBL,EAA0BM,EAAmB,CACjE,GAAI,CACF,OAAO,MAAM,YAAY,iBAAiB,MAAMA,CAAG,CAAC,CACtD,MAAE,CACA,OAAO,YAAY,QAAQ,EAAAC,QAAG,aAAaD,CAAG,CAAC,CACjD,CACF,CAEO,SAASL,EAAKO,EAAWC,EAAWC,EAAmB,CAC5D,OAAOD,EAAID,GAAKE,EAAID,EACtB,CAEA,SAASE,EAAgBC,EAA6BC,EAAW,CAC/D,IAAMC,EAAQF,EAAQ,UAAWG,GAAMA,EAAE,CAAC,GAAKF,CAAC,EAChD,GAAIC,EAAQ,EAAG,MAAO,CAACF,EAAQE,EAAQ,CAAC,EAAGF,EAAQE,CAAK,CAAC,EACzD,QAAQ,KAAK,eAAgBD,EAAGD,CAAO,CAEzC,CAEO,SAASb,EAAca,EAAoD,CAChF,OAAQC,GAAc,CACpB,IAAMG,EAASL,EAAgBC,EAASC,CAAC,EACzC,GAAI,CAACG,EAAQ,OAAOH,EAEpB,IAAM,GAAKA,EAAIG,EAAO,CAAC,EAAE,CAAC,IAAMA,EAAO,CAAC,EAAE,CAAC,EAAIA,EAAO,CAAC,EAAE,CAAC,GAG1D,OAFef,EAAK,EAAGe,EAAO,CAAC,EAAE,CAAC,EAAGA,EAAO,CAAC,EAAE,CAAC,CAAC,CAGnD,CACF,CAIA,eAAsBlB,GAAgC,CACpD,IAAMmB,EAAa,MAAMjB,EACvBK,EAAY,IACR,IAAI,IAAI,wBAAyBA,EAAY,GAAG,EAChD,EAAAa,QAAK,QAAQ,UAAW,uBAAuB,CACrD,EASA,OARqB,MAAM,YAAY,YAAYD,EAAY,CAC7D,IAAK,CACH,MAAQE,GAAc,CACpB,MAAM,IAAI,MAAM,gCAAkCA,CAAC,CACrD,CACF,CACF,CAAC,GAEmB,QAAQ,MAC9B","names":["ts_exports","__export","createPerlin","createSplines","fetchAndCompileWasmModule","lerp","__toCommonJS","import_fs","import_path","import_meta","url","fs","t","a","b","getSplinePoints","splines","x","index","s","points","wasmModule","path","e"]}
=======
{"version":3,"sources":["../ts/index.ts"],"sourcesContent":["import fs from \"fs\";\nimport path from \"path\";\n// import * as buffer from \"buffer\";\n// const { Buffer } = buffer;\n\n// export function encodePackedU32(inputs: number[]): Buffer {\n//   const buffer = Buffer.from(inputs.map((i) => i.toString(16).padStart(8, \"0\")).join(\"\"), \"hex\");\n//   return buffer;\n// }\n\nexport async function fetchAndCompileWasmModule(url: URL | string) {\n  try {\n    return await WebAssembly.compileStreaming(fetch(url));\n  } catch {\n    return WebAssembly.compile(fs.readFileSync(url));\n  }\n}\n\nexport function lerp(t: number, a: number, b: number): number {\n  return a + t * (b - a);\n}\n\nfunction getSplinePoints(splines: [number, number][], x: number) {\n  const index = splines.findIndex((s) => s[0] >= x);\n  if (index > 0) return [splines[index - 1], splines[index]];\n  console.warn(\"out of reach\", x, splines);\n  return undefined;\n}\n\nexport function createSplines(splines: [number, number][]): (x: number) => number {\n  return (x: number) => {\n    const points = getSplinePoints(splines, x);\n    if (!points) return x;\n\n    const t = (x - points[0][0]) / (points[1][0] - points[0][0]);\n    const height = lerp(t, points[0][1], points[1][1]);\n\n    return height;\n  };\n}\n\nexport type Perlin = (_x: number, _y: number, _z: number, denom: number) => number;\n\nexport async function createPerlin(): Promise<Perlin> {\n  const wasmModule = await fetchAndCompileWasmModule(\n    import.meta.url\n      ? new URL(\"../build/release.wasm\", import.meta.url)\n      : path.resolve(__dirname, \"../build/release.wasm\")\n  );\n  const wasmInstance = await WebAssembly.instantiate(wasmModule, {\n    env: {\n      abort: (e: string) => {\n        throw new Error(\"abort called in wasm perlin: \" + e);\n      },\n    },\n  });\n\n  return wasmInstance.exports.perlin as Perlin;\n}\n"],"mappings":"0jBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,kBAAAE,EAAA,kBAAAC,EAAA,8BAAAC,EAAA,SAAAC,IAAA,eAAAC,EAAAN,GAAA,IAAAO,EAAe,iBACfC,EAAiB,mBADjBC,EAAA,GAUA,eAAsBL,EAA0BM,EAAmB,CACjE,GAAI,CACF,OAAO,MAAM,YAAY,iBAAiB,MAAMA,CAAG,CAAC,CACtD,MAAE,CACA,OAAO,YAAY,QAAQ,EAAAC,QAAG,aAAaD,CAAG,CAAC,CACjD,CACF,CAEO,SAASL,EAAKO,EAAWC,EAAWC,EAAmB,CAC5D,OAAOD,EAAID,GAAKE,EAAID,EACtB,CAEA,SAASE,EAAgBC,EAA6BC,EAAW,CAC/D,IAAMC,EAAQF,EAAQ,UAAWG,GAAMA,EAAE,CAAC,GAAKF,CAAC,EAChD,GAAIC,EAAQ,EAAG,MAAO,CAACF,EAAQE,EAAQ,CAAC,EAAGF,EAAQE,CAAK,CAAC,EACzD,QAAQ,KAAK,eAAgBD,EAAGD,CAAO,CAEzC,CAEO,SAASb,EAAca,EAAoD,CAChF,OAAQC,GAAc,CACpB,IAAMG,EAASL,EAAgBC,EAASC,CAAC,EACzC,GAAI,CAACG,EAAQ,OAAOH,EAEpB,IAAM,GAAKA,EAAIG,EAAO,CAAC,EAAE,CAAC,IAAMA,EAAO,CAAC,EAAE,CAAC,EAAIA,EAAO,CAAC,EAAE,CAAC,GAG1D,OAFef,EAAK,EAAGe,EAAO,CAAC,EAAE,CAAC,EAAGA,EAAO,CAAC,EAAE,CAAC,CAAC,CAGnD,CACF,CAIA,eAAsBlB,GAAgC,CACpD,IAAMmB,EAAa,MAAMjB,EACvBK,EAAY,IACR,IAAI,IAAI,wBAAyBA,EAAY,GAAG,EAChD,EAAAa,QAAK,QAAQ,UAAW,uBAAuB,CACrD,EASA,OARqB,MAAM,YAAY,YAAYD,EAAY,CAC7D,IAAK,CACH,MAAQE,GAAc,CACpB,MAAM,IAAI,MAAM,gCAAkCA,CAAC,CACrD,CACF,CACF,CAAC,GAEmB,QAAQ,MAC9B","names":["ts_exports","__export","createPerlin","createSplines","fetchAndCompileWasmModule","lerp","__toCommonJS","import_fs","import_path","import_meta","url","fs","t","a","b","getSplinePoints","splines","x","index","s","points","wasmModule","path","e"]}
>>>>>>> a4f03cd4 (chore: export types)
